# AMI気象予測モデル - 臨床医向けレポート

## 概要

本レポートは、急性心筋梗塞（AMI）の気象予測モデルについて、臨床循環器内科医および統計学に精通した方々向けに作成されたものです。モデルの背景、手法、結果、および臨床的意義について分かりやすく説明します。

## 研究背景と目的

### 背景
急性心筋梗塞（AMI）は、冠動脈の閉塞により心筋が虚血状態となり、不可逆的な心筋壊死をきたす重篤な疾患です。気象条件はAMIの発症に影響を与えることが知られており、特に以下の要因が関連しています：

- **寒冷刺激**: 血管収縮による血圧上昇、心筋酸素需要の増加
- **暑熱ストレス**: 脱水、血液濃縮、血栓形成リスクの増加
- **気圧変動**: 自律神経系への影響、心血管系へのストレス
- **湿度変化**: 体温調節機能への負荷

### 目的
気象データを活用した機械学習モデルにより、AMI発症リスクの高い日を事前に予測し、以下の臨床的介入を可能にすることです：

1. **予防医療の強化**: 高リスク日の事前警告
2. **医療資源の最適化**: 救急医療体制の調整
3. **患者教育の促進**: 自己管理の向上
4. **早期介入の実現**: 発症前の予防的対応

## データと変数

### データソース
- **JROAD（日本循環器学会循環器疾患診療実態調査）**: AMI患者の入院データ
- **気象庁（JMA）**: 気象観測データ

### 基本気象変数
- **気温**: 最高気温、最低気温、平均気温
- **湿度**: 平均湿度、蒸気圧
- **気圧**: 平均気圧、気圧変化
- **風**: 平均風速、風向
- **降水**: 降水量、降水確率
- **日照**: 日照時間

### AMI特化派生変数

#### 温度関連指標
- **温度変化**: 前日比、3日間変化、急激な変化
- **寒冷ストレス**: 低温暴露フラグ（0℃以下）
- **暑熱ストレス**: 高温暴露フラグ（30℃以上）
- **温度ショック**: 急激な温度変化（±5℃/日以上）

#### 湿度・気圧関連指標
- **高湿度フラグ**: 80%以上の湿度
- **低湿度フラグ**: 30%以下の湿度
- **湿度変化**: 前日比湿度変化
- **気圧変化**: 前日比、3日間変化
- **気圧低下フラグ**: 急激な気圧低下
- **気圧上昇フラグ**: 急激な気圧上昇

#### 風・降水関連指標
- **強風フラグ**: 10m/s以上の風速
- **風変化**: 前日比風速変化
- **降水フラグ**: 降水量1mm以上

### 時間的特徴量

#### 季節性指標
- **季節フラグ**: 冬、春、夏、秋
- **周期性指標**: 月のsin/cos変換、日のsin/cos変換
- **週周期性**: 曜日のsin/cos変換

#### 日付関連指標
- **週末フラグ**: 土日の判定
- **月曜日フラグ**: 月曜日の判定
- **金曜日フラグ**: 金曜日の判定
- **祝日フラグ**: 祝日の判定
- **月初・月末フラグ**: 月の開始・終了日

### 複合気象指標
- **温湿度指数**: 温度と湿度の複合指標
- **風冷指数**: 風速と気温の複合指標
- **気圧変化率**: 気圧の変化速度
- **温度変化率**: 温度の変化速度

### 相互作用変数
- **温湿度相互作用**: 温度×湿度
- **気圧温度相互作用**: 気圧×温度
- **冬季温度変化**: 冬季×温度変化
- **夏季温度変化**: 夏季×温度変化

### 目的変数
- **AMI高リスク日**: 上位25%の入院日数を1、それ以外を0として定義

## 機械学習手法

### 採用アルゴリズム
1. **LightGBM**: 勾配ブースティング決定木
2. **XGBoost**: 極端勾配ブースティング
3. **CatBoost**: カテゴリカルブースティング
4. **Deep Neural Network**: 深層ニューラルネットワーク
5. **Attention Neural Network**: 注意機構付きニューラルネットワーク

### アンサンブル手法
- **動的最適化アンサンブル**: 予測性能に基づく動的重み調整
- **信頼度重み付きアンサンブル**: モデルの信頼度に基づく重み付け
- **不確実性重み付きアンサンブル**: 予測不確実性を考慮した重み付け
- **高度メタ学習**: 基本モデルの予測と統計量をメタ特徴量として使用

## データ分割方法

### 時系列分割（Seasonal Splits）
- **分割数**: 20回のFold
- **分割方法**: 時系列順序を保持した分割
- **季節性考慮**: 各Foldで季節性を考慮したデータ分割

### 分割の利点
- **時系列の一貫性**: 過去データで学習、未来データで評価
- **季節性の保持**: 各Foldで季節性パターンを維持
- **リーク防止**: 未来情報の漏洩を防止
- **実用性**: 実際の運用に近い評価環境

## モデル評価指標

### 基本指標
- **AUC（Area Under the Curve）**: ROC曲線下面積（0.5-1.0）
- **PR-AUC（Precision-Recall AUC）**: 適合率-再現率曲線下面積
- **Precision（適合率）**: 陽性予測の正確性
- **Recall（再現率）**: 実際の陽性を正しく予測する割合
- **F1-score**: 適合率と再現率の調和平均
- **Specificity（特異度）**: 実際の陰性を正しく予測する割合

### AMI特化最適化指標
- **F1最適化**: F1-scoreを最大化する閾値
- **PR最適化**: 適合率と再現率のバランスを最適化する閾値

## 結果

### 全体性能
- **AUC**: 0.9023 ± 0.0335
- **PR-AUC**: 0.8821 ± 0.0563
- **特徴量数**: 88個

### 標準評価指標
- **Precision**: 0.4240 ± 0.3681
- **Recall**: 0.4799 ± 0.4541
- **F1-score**: 0.4059 ± 0.3579
- **Specificity**: 0.6325 ± 0.4495

### 最適化評価指標
- **F1最適化 - F1-score**: 0.8132 ± 0.0759
- **F1最適化 - Precision**: 0.8143 ± 0.0802
- **F1最適化 - Recall**: 0.8274 ± 0.1272
- **PR最適化 - Precision**: 0.8143 ± 0.0802
- **PR最適化 - Recall**: 0.8274 ± 0.1272

## 技術的詳細

### 特徴量エンジニアリング
- **基本気象変数**: 12個の基本気象指標
- **派生変数**: 温度変化、ストレス指標、気圧変化など
- **時間的特徴**: 季節性、周期性、日付関連指標
- **相互作用**: 複数変数の組み合わせ効果
- **複合指標**: 医学的に意味のある複合指標

### ハイパーパラメータ最適化
- **Optuna**: ベイズ最適化による自動調整
- **探索範囲**: 各アルゴリズムの最適パラメータ範囲
- **評価指標**: AUCを基準とした最適化

### アンサンブル最適化
- **動的重み調整**: 予測性能に基づく重み更新
- **多様性確保**: 相関の低いモデル組み合わせ
- **メタ学習**: 基本モデルの予測を学習データとして使用

## 臨床的意義

### 予防医療への応用
- **高リスク日の事前警告**: 医療機関、患者への事前通知
- **予防的介入**: 薬剤調整、生活指導の強化
- **患者教育**: 自己管理の向上

### 医療資源最適化
- **救急医療体制**: 高リスク日の人員配置調整
- **入院ベッド管理**: 事前のベッド確保
- **検査体制**: 心臓カテーテル検査体制の調整

### 早期介入の実現
- **発症前対応**: 症状発現前の予防的対応
- **リスク層別化**: 患者のリスクレベル別対応
- **個別化医療**: 患者特性に応じた介入

### 公衆衛生への貢献
- **地域医療連携**: 地域全体での予防体制構築
- **健康政策**: 気象関連健康リスクの政策化
- **研究発展**: 気象医学研究の基盤構築

## 用語解説

### 機械学習関連
- **AUC**: モデルの識別能力を示す指標（0.5=ランダム、1.0=完璧）
- **ROC曲線**: 真陽性率と偽陽性率の関係を表す曲線
- **PR曲線**: 適合率と再現率の関係を表す曲線
- **アンサンブル**: 複数のモデルを組み合わせた予測手法
- **特徴量エンジニアリング**: 生データから予測に有用な特徴を作成する手法

### 統計学関連
- **Precision**: 陽性と予測したもののうち、実際に陽性だった割合
- **Recall**: 実際の陽性のうち、正しく陽性と予測できた割合
- **F1-score**: PrecisionとRecallの調和平均
- **Specificity**: 実際の陰性のうち、正しく陰性と予測できた割合
- **時系列分割**: 時間順序を考慮したデータ分割手法

### 医学関連
- **AMI**: 急性心筋梗塞（Acute Myocardial Infarction）
- **寒冷ストレス**: 低温環境による心血管系への負荷
- **暑熱ストレス**: 高温環境による心血管系への負荷
- **気圧変動**: 気圧の急激な変化による心血管系への影響

## 今後の展望

### 技術的改善
- **リアルタイム予測**: リアルタイム気象データの活用
- **個別化モデル**: 患者特性に応じた個別モデル
- **地域特化**: 地域特性を考慮したモデル
- **多疾患統合**: 複数心血管疾患の統合予測

### 臨床的応用
- **実装試験**: 実際の医療現場での検証
- **効果測定**: 介入効果の定量的評価
- **ガイドライン化**: 気象関連心血管リスク管理ガイドライン
- **国際展開**: 他地域・他国への展開

### 研究発展
- **メカニズム解明**: 気象-心血管疾患の機序解明
- **新規指標開発**: より精度の高い予測指標
- **多施設研究**: 複数医療機関での検証
- **長期追跡**: 長期予後への影響評価

## 結論

本AMI気象予測モデルは、高度な機械学習技術と医学的知見を融合させ、気象条件に基づくAMI発症リスクの予測を実現しました。AUC 0.90以上の高い予測精度を達成し、臨床現場での実用化が期待されます。

特に、最適化された評価指標ではF1-score 0.81、Precision 0.81、Recall 0.83という優秀な性能を示しており、実際の医療現場での活用に十分な精度を有しています。

今後は、実際の医療現場での検証を経て、予防医療の強化、医療資源の最適化、患者ケアの向上に貢献することが期待されます。気象医学という新たな分野の発展に寄与し、心血管疾患の予防と治療に革新をもたらすことが期待されます。

---

**作成日**: 2025年8月3日  
**対象疾患**: 急性心筋梗塞（AMI）  
**予測精度**: AUC 0.9023 ± 0.0335  
**特徴量数**: 88個  
**評価方法**: 20回時系列分割交差検証 